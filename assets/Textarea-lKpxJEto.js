import{j as b,e as h,k as $}from"./vendor-primer-CxVDLtAo.js";import{b as o}from"./vendor-react-C38C2D6M.js";import{F as C,s as g,u as D}from"./FormContext-BUZxcrzV.js";function R({data:e,onSubmit:f,children:i,...l}){const s=e||null,a=o.useRef({}),r=o.useRef({}),x=o.useCallback(t=>a.current[t],[]),n=o.useCallback((t,c)=>{a.current[t]=c;const v=r.current[t];v&&v(c)},[]),u=o.useCallback((t,c)=>(r.current[t]=c,()=>{delete r.current[t]}),[]),p=t=>{if(t.preventDefault(),s)for(const[c,v]of Object.entries(a.current))g(`${s}.${c}`,v);f&&f(t)},d={prefix:s,getDraft:x,setDraft:n,subscribe:u};return b.jsx(C.Provider,{value:d,children:b.jsx("form",{...l,onSubmit:p,children:i})})}function T({name:e,onChange:f,value:i,...l}){const s=o.useContext(C),a=s?.prefix&&e?`${s.prefix}.${e}`:e,[r]=D(a||""),[x,n]=o.useState(r??""),u=!!s&&!!e;o.useEffect(()=>{if(u)return s.subscribe(e,t=>n(t))},[u,s,e]),o.useEffect(()=>{u&&r!=null&&(n(r),s.setDraft(e,r))},[]);const p=t=>{u&&(n(t.target.value),s.setDraft(e,t.target.value)),f&&f(t)},d=u?x:i;return b.jsx(h,{name:e,value:d,onChange:p,...l})}function V({name:e,onChange:f,value:i,...l}){const s=o.useContext(C),a=s?.prefix&&e?`${s.prefix}.${e}`:e,[r]=D(a||""),[x,n]=o.useState(r??""),u=!!s&&!!e;o.useEffect(()=>{if(u)return s.subscribe(e,t=>n(t))},[u,s,e]),o.useEffect(()=>{u&&r!=null&&(n(r),s.setDraft(e,r))},[]);const p=t=>{u&&(n(t.target.value),s.setDraft(e,t.target.value)),f&&f(t)},d=u?x:i;return b.jsx($,{name:e,value:d,onChange:p,...l})}export{R as S,T,V as a};
